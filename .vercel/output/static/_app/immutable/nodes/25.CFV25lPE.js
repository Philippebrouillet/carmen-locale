import{P as De}from"../chunks/public.BeJSVsf1.js";import{f as Tt,g as kt}from"../chunks/Location.Cha5LnI8.js";import{e as Oe}from"../chunks/index.g5YcAAdQ.js";import{s as we,K as Ce,N as $e,z as ft,C as ct,D as dt,E as pt,e as w,c as E,b as P,f as c,m as b,J as Te,i as L,h as m,H as wt,a as O,t as z,g as $,d as H,B as je,j as ue,n as ie,q as Ae,U as Ue,W as Ne,S as mt,l as ze,I as Et,V as qe,ae as Be,k as yt,F as Pt,G as Dt}from"../chunks/scheduler.BoY_d1jh.js";import{S as Ee,i as ye,c as X,b as le,m as ee,a as D,t as F,d as te,e as Ct,g as pe,f as me,h as Ve}from"../chunks/index.C5ymHmkt.js";import{g as Re,a as Me}from"../chunks/spread.CgU5AtxT.js";import{F as It}from"../chunks/Footer.BOGt8KrF.js";import{f as At}from"../chunks/index.BN-p4Om7.js";import{c as St}from"../chunks/clock.svelte.pa43Gjrj.js";import{L as Lt,E as Nt,a as Ft}from"../chunks/ExternalLinks.klIqX3VW.js";import{c as qt}from"../chunks/QueueLine.BJWQvMVK.js";import{l as Ie}from"../chunks/runtime.CTS-Dfby.js";import{a as Fe,d as He}from"../chunks/formater.C10dx8Nx.js";import{I as Bt,W as Vt,P as Rt}from"../chunks/Popup.CabQG2lt.js";import{S as _t,D as Mt,C as Le}from"../chunks/store.DK6I_54P.js";import{I as Ot}from"../chunks/Icon.f0l2BVv8.js";import{B as gt}from"../chunks/button.CQ44d0JB.js";import"../chunks/entry.DwtEXdz5.js";import{e as We}from"../chunks/each.VpouubDL.js";const $t=()=>"pers. dans la file devant vous",jt=()=>"الناس أمامك",Ut=()=>"people ahead of you",zt=()=>"gente delante de ti",Ht=()=>"आपसे आगे के लोग",Wt=()=>"persone davanti a te",Kt=()=>"mensen vóór je",Gt=()=>"pessoas à sua frente",Jt=()=>"люди впереди тебя",Qt=()=>"在你前面的人",Zt=(i={},e={})=>({ar:jt,en:Ut,es:zt,fr:$t,hi:Ht,it:Wt,nl:Kt,pt:Gt,ru:Jt,zh:Qt})[e.languageTag??Ie()]();function Yt(i){let e;const t=i[2].default,n=ft(t,i,i[3],null);return{c(){n&&n.c()},l(s){n&&n.l(s)},m(s,l){n&&n.m(s,l),e=!0},p(s,l){n&&n.p&&(!e||l&8)&&ct(n,t,s,s[3],e?pt(t,s[3],l,null):dt(s[3]),null)},i(s){e||(D(n,s),e=!0)},o(s){F(n,s),e=!1},d(s){n&&n.d(s)}}}function xt(i){let e,t;const n=[{name:"bell"},i[1],{iconNode:i[0]}];let s={$$slots:{default:[Yt]},$$scope:{ctx:i}};for(let l=0;l<n.length;l+=1)s=Ce(s,n[l]);return e=new Ot({props:s}),{c(){X(e.$$.fragment)},l(l){le(e.$$.fragment,l)},m(l,u){ee(e,l,u),t=!0},p(l,[u]){const o=u&3?Re(n,[n[0],u&2&&Me(l[1]),u&1&&{iconNode:l[0]}]):{};u&8&&(o.$$scope={dirty:u,ctx:l}),e.$set(o)},i(l){t||(D(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Xt(i,e,t){let{$$slots:n={},$$scope:s}=e;const l=[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0"}]];return i.$$set=u=>{t(1,e=Ce(Ce({},e),$e(u))),"$$scope"in u&&t(3,s=u.$$scope)},e=$e(e),[l,e,n,s]}class en extends Ee{constructor(e){super(),ye(this,e,Xt,xt,we,{})}}async function tn({params:i,fetch:e}){const t=i.slug,n=await e(`${De}/api/v2/ticket/${t}`);let s=null;if(n.ok)s=await n.json(),console.log("ticket",s);else return Oe(404,"Not found");const l=await e(`${De}/api/v3/location/${s.ticket.locationId}`),u=await e(`${De}/api/v1/location/${s.ticket.locationId}/config`);if(l.ok){const o=await l.json(),a=Tt(o),r=await u.json();return{...s,location:a,config:r.config}}return Oe(404,"Not found")}const ei=Object.freeze(Object.defineProperty({__proto__:null,load:tn},Symbol.toStringTag,{value:"Module"}));function nn(i){let e,t,n,s,l;const u=i[3].default,o=ft(u,i,i[2],null);return{c(){e=w("div"),t=w("div"),o&&o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var r=P(e);t=E(r,"DIV",{class:!0});var f=P(t);o&&o.l(f),f.forEach(c),r.forEach(c),this.h()},h(){b(t,"class",n="flex flex-col items-center gap-12 w-full min-w-72 border rounded-3xl shadow-xl py-6 px-6 md:py-8 md:px-8 "+i[1]),Te(t,"sticky",i[0]),Te(t,"top-16",i[0]),b(e,"class","hidden lg:flex flex-col gap-6 items-center w-full")},m(a,r){L(a,e,r),m(e,t),o&&o.m(t,null),l=!0},p(a,[r]){o&&o.p&&(!l||r&4)&&ct(o,u,a,a[2],l?pt(u,a[2],r,null):dt(a[2]),null),(!l||r&2&&n!==(n="flex flex-col items-center gap-12 w-full min-w-72 border rounded-3xl shadow-xl py-6 px-6 md:py-8 md:px-8 "+a[1]))&&b(t,"class",n),(!l||r&3)&&Te(t,"sticky",a[0]),(!l||r&3)&&Te(t,"top-16",a[0])},i(a){l||(D(o,a),a&&(s||wt(()=>{s=Ct(e,At,{y:100,duration:300}),s.start()})),l=!0)},o(a){F(o,a),l=!1},d(a){a&&c(e),o&&o.d(a)}}}function sn(i,e,t){let{$$slots:n={},$$scope:s}=e,{sticky:l=!0}=e,{style:u=""}=e;return i.$$set=o=>{"sticky"in o&&t(0,l=o.sticky),"style"in o&&t(1,u=o.style),"$$scope"in o&&t(2,s=o.$$scope)},[l,u,s,n]}class ln extends Ee{constructor(e){super(),ye(this,e,sn,nn,we,{sticky:0,style:1})}}function Ke(i){let e,t='<svg width="13" height="20" viewBox="0 0 13 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.16794 4C8.27254 4 9.16794 3.10457 9.16794 2C9.16794 0.89543 8.27254 0 7.16794 0C6.06344 0 5.16794 0.89543 5.16794 2C5.16794 3.10457 6.06344 4 7.16794 4ZM5.22074 4.60557C5.55204 4.43992 5.94784 4.47097 6.24924 4.68627L7.24924 5.40056C7.56734 5.6278 7.72384 6.01959 7.64994 6.40348L6.60114 11.847L11 18.4453C11.3063 18.9048 11.1822 19.5257 10.7226 19.8321C10.2631 20.1384 9.64224 20.0142 9.33594 19.5547L4.70954 12.6152L3.89405 11.3919C3.7513 11.1778 3.6966 10.9169 3.74132 10.6634L4.33784 7.28309L2.55258 8.1757L1.98076 11.0334C1.87239 11.575 1.34553 11.9261 0.80398 11.8178C0.26243 11.7094 -0.0887299 11.1825 0.0196301 10.641L0.68741 7.30379C0.74795 7.00123 0.94478 6.74356 1.22076 6.60557L5.22074 4.60557ZM10.8517 10.9487L7.97724 9.9905L8.35884 8.0096L11.4842 9.0513C12.0081 9.226 12.2913 9.7923 12.1166 10.3162C11.942 10.8402 11.3757 11.1234 10.8517 10.9487ZM0.29638 18.5097L3.56431 12.7001L3.87752 13.1699L4.80894 14.5669L2.03953 19.4903C1.76877 19.9716 1.15905 20.1423 0.6777 19.8716C0.19634 19.6008 0.0256201 18.9911 0.29638 18.5097Z" fill="black"></path></svg>';return{c(){e=w("div"),e.innerHTML=t,this.h()},l(n){e=E(n,"DIV",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-syh2yc"&&(e.innerHTML=t),this.h()},h(){b(e,"class","rounded-full px-2.5 py-1.5 bg-neutral-200 flex justify-center items-center")},m(n,s){L(n,e,s)},d(n){n&&c(e)}}}function Ge(i){let e,t,n,s;function l(r,f){return r[2]==="inProgress"?rn:on}let u=l(i),o=u(i),a=i[3]>-1&&Je(i);return{c(){e=w("div"),t=w("div"),o.c(),s=O(),a&&a.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var f=P(e);t=E(f,"DIV",{class:!0});var d=P(t);o.l(d),d.forEach(c),s=$(f),a&&a.l(f),f.forEach(c),this.h()},h(){b(t,"class",n="font-bold text-[#616163] flex gap-2 justify-between text-sm "+(i[3]?"mb-2":"")),b(e,"class","flex flex-col w-full justify-center bg-[#F7F7F7] rounded-lg p-4 gap-2")},m(r,f){L(r,e,f),m(e,t),o.m(t,null),m(e,s),a&&a.m(e,null)},p(r,f){u===(u=l(r))&&o?o.p(r,f):(o.d(1),o=u(r),o&&(o.c(),o.m(t,null))),f&8&&n!==(n="font-bold text-[#616163] flex gap-2 justify-between text-sm "+(r[3]?"mb-2":""))&&b(t,"class",n),r[3]>-1?a?a.p(r,f):(a=Je(r),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(r){r&&c(e),o.d(),a&&a.d()}}}function on(i){let e,t,n,s,l=Zt()+"",u,o,a;return{c(){e=w("span"),t=z(i[0]),n=O(),s=w("span"),u=z(l),o=O(),a=w("span"),this.h()},l(r){e=E(r,"SPAN",{class:!0});var f=P(e);t=H(f,i[0]),f.forEach(c),n=$(r),s=E(r,"SPAN",{class:!0});var d=P(s);u=H(d,l),d.forEach(c),o=$(r),a=E(r,"SPAN",{}),P(a).forEach(c),this.h()},h(){b(e,"class","text-[1.875rem] text-primary"),b(s,"class","self-end")},m(r,f){L(r,e,f),m(e,t),L(r,n,f),L(r,s,f),m(s,u),L(r,o,f),L(r,a,f)},p(r,f){f&1&&ue(t,r[0])},d(r){r&&(c(e),c(n),c(s),c(o),c(a))}}}function rn(i){let e;return{c(){e=z("Progression")},l(t){e=H(t,"Progression")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function Je(i){let e,t,n,s;function l(a,r){return a[2]==="inProgress"?fn:a[3]>75?un:an}let u=l(i),o=u(i);return{c(){e=w("div"),t=w("div"),n=O(),s=w("p"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var r=P(e);t=E(r,"DIV",{class:!0,style:!0}),P(t).forEach(c),r.forEach(c),n=$(a),s=E(a,"P",{class:!0});var f=P(s);o.l(f),f.forEach(c),this.h()},h(){b(t,"class","h-4 bg-[#616163]"),Ue(t,"width",i[3]+"%"),b(e,"class","h-4 w-full rounded-[6px] bg-[#DFE5E7] overflow-hidden"),b(s,"class","md:text-md text-xs text-secondary")},m(a,r){L(a,e,r),m(e,t),L(a,n,r),L(a,s,r),o.m(s,null)},p(a,r){r&8&&Ue(t,"width",a[3]+"%"),u===(u=l(a))&&o?o.p(a,r):(o.d(1),o=u(a),o&&(o.c(),o.m(s,null)))},d(a){a&&(c(e),c(n),c(s)),o.d()}}}function an(i){let e;return{c(){e=z("Progression du client devant vous")},l(t){e=H(t,"Progression du client devant vous")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function un(i){let e;return{c(){e=z("Le client devant vous a bientôt fini")},l(t){e=H(t,"Le client devant vous a bientôt fini")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function fn(i){let e=i[1].name+"",t,n;return{c(){t=z(e),n=z(" débute sont service")},l(s){t=H(s,e),n=H(s," débute sont service")},m(s,l){L(s,t,l),L(s,n,l)},p(s,l){l&2&&e!==(e=s[1].name+"")&&ue(t,e)},d(s){s&&(c(t),c(n))}}}function cn(i){var J,Q;let e,t,n,s,l,u,o,a=((J=i[5])==null?void 0:J.title)+"",r,f,d,_,g,T=((Q=i[5])==null?void 0:Q.description)+"",C,U,x,Z=["iminent, youAreNext"].includes(i[2])&&i[4],ne,y,j=Z&&Ke(),k=i[2]!=="done"&&i[2]!=="yourTurn"&&!i[6]&&Ge(i);return{c(){e=w("div"),t=w("div"),n=w("img"),l=O(),u=w("div"),o=w("p"),r=z(a),d=O(),_=w("div"),g=w("p"),C=z(T),x=O(),j&&j.c(),ne=O(),k&&k.c(),this.h()},l(q){e=E(q,"DIV",{class:!0});var I=P(e);t=E(I,"DIV",{class:!0});var W=P(t);n=E(W,"IMG",{src:!0,class:!0,alt:!0}),l=$(W),u=E(W,"DIV",{class:!0});var R=P(u);o=E(R,"P",{class:!0});var fe=P(o);r=H(fe,a),fe.forEach(c),d=$(R),_=E(R,"DIV",{class:!0});var K=P(_);g=E(K,"P",{class:!0});var M=P(g);C=H(M,T),M.forEach(c),x=$(K),j&&j.l(K),K.forEach(c),R.forEach(c),W.forEach(c),ne=$(I),k&&k.l(I),I.forEach(c),this.h()},h(){je(n.src,s=i[1].avatar)||b(n,"src",s),b(n,"class","rounded-full w-14 h-14"),b(n,"alt","profile"),b(o,"class",f="font-bold text-lg "+(i[7]?"text-white":"text-primary")),b(g,"class",U="text-xs "+(i[7]?"text-white":"text-secondary")),b(_,"class","flex gap-4 items-center justify-between w-full"),b(u,"class","flex flex-col w-full"),b(t,"class","flex gap-2"),b(e,"class",y=(i[7]?"bg-primary":"bg-white")+" p-4 flex rounded-2xl shadow-sm flex-col gap-2 w-full")},m(q,I){L(q,e,I),m(e,t),m(t,n),m(t,l),m(t,u),m(u,o),m(o,r),m(u,d),m(u,_),m(_,g),m(g,C),m(_,x),j&&j.m(_,null),m(e,ne),k&&k.m(e,null)},p(q,[I]){var W,R;I&2&&!je(n.src,s=q[1].avatar)&&b(n,"src",s),I&32&&a!==(a=((W=q[5])==null?void 0:W.title)+"")&&ue(r,a),I&128&&f!==(f="font-bold text-lg "+(q[7]?"text-white":"text-primary"))&&b(o,"class",f),I&32&&T!==(T=((R=q[5])==null?void 0:R.description)+"")&&ue(C,T),I&128&&U!==(U="text-xs "+(q[7]?"text-white":"text-secondary"))&&b(g,"class",U),I&20&&(Z=["iminent, youAreNext"].includes(q[2])&&q[4]),Z?j||(j=Ke(),j.c(),j.m(_,null)):j&&(j.d(1),j=null),q[2]!=="done"&&q[2]!=="yourTurn"&&!q[6]?k?k.p(q,I):(k=Ge(q),k.c(),k.m(e,null)):k&&(k.d(1),k=null),I&128&&y!==(y=(q[7]?"bg-primary":"bg-white")+" p-4 flex rounded-2xl shadow-sm flex-col gap-2 w-full")&&b(e,"class",y)},i:ie,o:ie,d(q){q&&c(e),j&&j.d(),k&&k.d()}}}function dn(i,e,t){let n,s,{queuePosition:l}=e,{queueInfo:u}=e,{ticketStatus:o}=e,{ticketProgress:a=0}=e,{isExpectedTimeClose:r}=e;const f={coming:{title:`${u.name} est occupé`,description:"Service en cours"},youAreNext:{title:"Vous êtes le prochain",description:"Merci de vous rendre au salon et de rester à proximité immédiate."},iminent:{title:"Vous êtes le prochain",description:"Merci de vous rendre au salon et de rester à proximité immédiate."},yourTurn:{title:"C’est à vous.",description:`${u.name} vous attends sur place.`},inProgress:{title:"Service en cours",description:"Installez-vous confortablement et détendez-vous."},done:{title:"Merci de votre confiance",description:"À très bientôt !"},isLate:{title:"Votre tour approche",description:"Service en cours"}};let d=f[o];return i.$$set=_=>{"queuePosition"in _&&t(0,l=_.queuePosition),"queueInfo"in _&&t(1,u=_.queueInfo),"ticketStatus"in _&&t(2,o=_.ticketStatus),"ticketProgress"in _&&t(3,a=_.ticketProgress),"isExpectedTimeClose"in _&&t(4,r=_.isExpectedTimeClose)},i.$$.update=()=>{i.$$.dirty&20&&t(5,d=["iminent","youAreNext"].includes(o)&&!r?f.coming:f[o]),i.$$.dirty&4&&t(7,n=o==="yourTurn"||o==="done"),i.$$.dirty&5&&t(6,s=o==="coming"&&l===0)},[l,u,o,a,r,d,s,n]}class ht extends Ee{constructor(e){super(),ye(this,e,dn,cn,we,{queuePosition:0,queueInfo:1,ticketStatus:2,ticketProgress:3,isExpectedTimeClose:4})}}function Qe(i){let e,t,n,s,l=i[8].text+"",u,o,a;var r=i[8].icon;function f(d,_){return{props:{size:"14"}}}return r&&(t=Ne(r,f())),{c(){e=w("div"),t&&X(t.$$.fragment),n=O(),s=w("p"),u=z(l),this.h()},l(d){e=E(d,"DIV",{class:!0});var _=P(e);t&&le(t.$$.fragment,_),n=$(_),s=E(_,"P",{class:!0});var g=P(s);u=H(g,l),g.forEach(c),_.forEach(c),this.h()},h(){b(s,"class","font-bold uppercase text-xs"),b(e,"class",o="py-1 px-2 rounded-lg flex flex-row gap-1.5 items-center text-white "+("bg"in i[8]?i[8].bg:i[12][i[6]])+" svelte-l0thby")},m(d,_){L(d,e,_),t&&ee(t,e,null),m(e,n),m(e,s),m(s,u),a=!0},p(d,_){if(_&256&&r!==(r=d[8].icon)){if(t){pe();const g=t;F(g.$$.fragment,1,0,()=>{te(g,1)}),me()}r?(t=Ne(r,f()),X(t.$$.fragment),D(t.$$.fragment,1),ee(t,e,n)):t=null}(!a||_&256)&&l!==(l=d[8].text+"")&&ue(u,l),(!a||_&320&&o!==(o="py-1 px-2 rounded-lg flex flex-row gap-1.5 items-center text-white "+("bg"in d[8]?d[8].bg:d[12][d[6]])+" svelte-l0thby"))&&b(e,"class",o)},i(d){a||(t&&D(t.$$.fragment,d),a=!0)},o(d){t&&F(t.$$.fragment,d),a=!1},d(d){d&&c(e),t&&te(t)}}}function pn(i){let e;return{c(){e=z(i[10])},l(t){e=H(t,i[10])},m(t,n){L(t,e,n)},p(t,n){n&1024&&ue(e,t[10])},d(t){t&&c(e)}}}function mn(i){let e;return{c(){e=z("Maintenant")},l(t){e=H(t,"Maintenant")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function _n(i){let e;return{c(){e=z("En cours")},l(t){e=H(t,"En cours")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function gn(i){let e;return{c(){e=z("Annulé")},l(t){e=H(t,"Annulé")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function hn(i){let e;return{c(){e=z("Terminé")},l(t){e=H(t,"Terminé")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function Ze(i){let e,t,n,s,l,u,o;return{c(){e=w("div"),t=w("div"),s=O(),l=w("div"),u=w("div"),this.h()},l(a){e=E(a,"DIV",{class:!0});var r=P(e);t=E(r,"DIV",{class:!0}),P(t).forEach(c),s=$(r),l=E(r,"DIV",{class:!0});var f=P(l);u=E(f,"DIV",{class:!0}),P(u).forEach(c),f.forEach(c),r.forEach(c),this.h()},h(){b(t,"class",n="pulse-ring border "+(i[6]==="NEUTRAL"?"border-[#616163]":i[13][i[6]])+" svelte-l0thby"),b(u,"class",o="min-h-2 min-w-2 rounded-full "+(i[6]==="NEUTRAL"?"bg-[#616163]":i[12][i[6]])+" svelte-l0thby"),b(l,"class","p-1"),b(e,"class","relative self-start")},m(a,r){L(a,e,r),m(e,t),m(e,s),m(e,l),m(l,u)},p(a,r){r&64&&n!==(n="pulse-ring border "+(a[6]==="NEUTRAL"?"border-[#616163]":a[13][a[6]])+" svelte-l0thby")&&b(t,"class",n),r&64&&o!==(o="min-h-2 min-w-2 rounded-full "+(a[6]==="NEUTRAL"?"bg-[#616163]":a[12][a[6]])+" svelte-l0thby")&&b(u,"class",o)},d(a){a&&c(e)}}}function vn(i){let e,t="Horaire prévue";return{c(){e=w("p"),e.textContent=t,this.h()},l(n){e=E(n,"P",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-3zn5jr"&&(e.textContent=t),this.h()},h(){b(e,"class","font-bold text-secondary uppercase text-sm")},m(n,s){L(n,e,s)},p:ie,i:ie,o:ie,d(n){n&&c(e)}}}function bn(i){let e,t,n=i[7]&&Ye(i);return{c(){n&&n.c(),e=ze()},l(s){n&&n.l(s),e=ze()},m(s,l){n&&n.m(s,l),L(s,e,l),t=!0},p(s,l){s[7]?n?(n.p(s,l),l&128&&D(n,1)):(n=Ye(s),n.c(),D(n,1),n.m(e.parentNode,e)):n&&(pe(),F(n,1,1,()=>{n=null}),me())},i(s){t||(D(n),t=!0)},o(s){F(n),t=!1},d(s){s&&c(e),n&&n.d(s)}}}function Ye(i){let e,t,n,s,l=i[7].text+"",u,o,a,r,f;var d=i[7].icon;function _(T,C){return{props:{size:"14"}}}d&&(t=Ne(d,_()));let g=i[4]==="inProgress"&&xe(i);return{c(){e=w("div"),t&&X(t.$$.fragment),n=O(),s=w("p"),u=z(l),a=O(),g&&g.c(),this.h()},l(T){e=E(T,"DIV",{class:!0});var C=P(e);t&&le(t.$$.fragment,C),n=$(C),s=E(C,"P",{class:!0});var U=P(s);u=H(U,l),U.forEach(c),a=$(C),g&&g.l(C),C.forEach(c),this.h()},h(){b(s,"class",o="text-xs font-extrabold uppercase "+i[7].textColor+" svelte-l0thby"),b(e,"class",r="py-1 px-2 rounded-2xl "+("bg"in i[7]?`${i[7].bg} `:"bg-[#DFE5E7] bg-opacity-30 ")+" "+("textColor"in i[7]?i[7].textColor:i[14][i[6]])+" flex items-center gap-1 svelte-l0thby")},m(T,C){L(T,e,C),t&&ee(t,e,null),m(e,n),m(e,s),m(s,u),m(e,a),g&&g.m(e,null),f=!0},p(T,C){if(C&128&&d!==(d=T[7].icon)){if(t){pe();const U=t;F(U.$$.fragment,1,0,()=>{te(U,1)}),me()}d?(t=Ne(d,_()),X(t.$$.fragment),D(t.$$.fragment,1),ee(t,e,n)):t=null}(!f||C&128)&&l!==(l=T[7].text+"")&&ue(u,l),(!f||C&128&&o!==(o="text-xs font-extrabold uppercase "+T[7].textColor+" svelte-l0thby"))&&b(s,"class",o),T[4]==="inProgress"?g?g.p(T,C):(g=xe(T),g.c(),g.m(e,null)):g&&(g.d(1),g=null),(!f||C&192&&r!==(r="py-1 px-2 rounded-2xl "+("bg"in T[7]?`${T[7].bg} `:"bg-[#DFE5E7] bg-opacity-30 ")+" "+("textColor"in T[7]?T[7].textColor:T[14][T[6]])+" flex items-center gap-1 svelte-l0thby"))&&b(e,"class",r)},i(T){f||(t&&D(t.$$.fragment,T),f=!0)},o(T){t&&F(t.$$.fragment,T),f=!1},d(T){T&&c(e),t&&te(t),g&&g.d()}}}function xe(i){let e,t=new Date(i[1].expectedTime).toLocaleTimeString(Ie(),{hour:"2-digit",minute:"2-digit"})+"",n;return{c(){e=w("span"),n=z(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var l=P(e);n=H(l,t),l.forEach(c),this.h()},h(){b(e,"class","text-xs font-extrabold")},m(s,l){L(s,e,l),m(e,n)},p(s,l){l&2&&t!==(t=new Date(s[1].expectedTime).toLocaleTimeString(Ie(),{hour:"2-digit",minute:"2-digit"})+"")&&ue(n,t)},d(s){s&&c(e)}}}function Xe(i){let e,t,n,s,l,u,o;return s=new Bt({props:{size:"11",class:"min-w-[11px] cursor-pointer"}}),{c(){e=w("p"),t=z("Estimation dynamique liée à l’activité sur place "),n=w("button"),X(s.$$.fragment),this.h()},l(a){e=E(a,"P",{class:!0});var r=P(e);t=H(r,"Estimation dynamique liée à l’activité sur place "),n=E(r,"BUTTON",{});var f=P(n);le(s.$$.fragment,f),f.forEach(c),r.forEach(c),this.h()},h(){b(e,"class","text-[#616163] text-xs flex items-center gap-1")},m(a,r){L(a,e,r),m(e,t),m(e,n),ee(s,n,null),l=!0,u||(o=mt(n,"click",i[19]),u=!0)},p:ie,i(a){l||(D(s.$$.fragment,a),l=!0)},o(a){F(s.$$.fragment,a),l=!1},d(a){a&&c(e),te(s),u=!1,o()}}}function et(i){let e,t,n=i[3].name+"",s,l,u,o=i[3].duration+"",a,r;return{c(){e=w("div"),t=w("span"),s=z(n),l=O(),u=w("span"),a=z(o),r=z(" minutes"),this.h()},l(f){e=E(f,"DIV",{class:!0});var d=P(e);t=E(d,"SPAN",{class:!0});var _=P(t);s=H(_,n),_.forEach(c),l=$(d),u=E(d,"SPAN",{class:!0});var g=P(u);a=H(g,o),r=H(g," minutes"),g.forEach(c),d.forEach(c),this.h()},h(){b(t,"class","text-primary"),b(u,"class","text-secondary"),b(e,"class","flex flex-col gap-2 items-center")},m(f,d){L(f,e,d),m(e,t),m(t,s),m(e,l),m(e,u),m(u,a),m(u,r)},p(f,d){d&8&&n!==(n=f[3].name+"")&&ue(s,n),d&8&&o!==(o=f[3].duration+"")&&ue(a,o)},d(f){f&&c(e)}}}function Tn(i){let e,t,n,s,l,u,o,a,r,f,d,_=(new Date(i[1].expectedTime).toDateString()===new Date().toDateString()?"Aujourd'hui":new Date(i[1].expectedTime).toLocaleDateString(Ie(),{weekday:"short",day:"numeric",month:"short"}))+"",g,T,C,U,x,Z,ne,y,j,k,J,Q,q,I,W,R=i[2]&&i[8]&&!i[5]&&Qe(i);function fe(h,S){return h[4]==="done"?hn:h[5]?gn:h[4]==="inProgress"?_n:h[4]==="yourTurn"?mn:pn}let K=fe(i),M=K(i),B=(i[4]==="coming"||i[4]==="youAreNext"||i[4]==="iminent")&&Ze(i);const re=[bn,vn],ce=[];function he(h,S){return h[2]?0:1}y=he(i),j=ce[y]=re[y](i);let N=i[2]&&i[4]!=="yourTurn"&&i[4]!=="inProgress"&&i[4]!=="done"&&!i[5]&&Xe(i),V=i[3]&&et(i);return{c(){e=w("div"),t=w("div"),n=w("p"),s=z("#"),l=z(i[11]),o=O(),R&&R.c(),a=O(),r=w("div"),f=w("div"),d=w("p"),g=z(_),T=O(),C=w("div"),U=w("span"),M.c(),Z=O(),B&&B.c(),ne=O(),j.c(),k=O(),N&&N.c(),J=O(),Q=w("div"),q=O(),V&&V.c(),this.h()},l(h){e=E(h,"DIV",{class:!0});var S=P(e);t=E(S,"DIV",{class:!0});var de=P(t);n=E(de,"P",{class:!0});var ve=P(n);s=H(ve,"#"),l=H(ve,i[11]),ve.forEach(c),o=$(de),R&&R.l(de),de.forEach(c),a=$(S),r=E(S,"DIV",{class:!0});var p=P(r);f=E(p,"DIV",{class:!0});var A=P(f);d=E(A,"P",{class:!0});var oe=P(d);g=H(oe,_),oe.forEach(c),T=$(A),C=E(A,"DIV",{class:!0});var v=P(C);U=E(v,"SPAN",{class:!0});var G=P(U);M.l(G),G.forEach(c),Z=$(v),B&&B.l(v),v.forEach(c),ne=$(A),j.l(A),A.forEach(c),k=$(p),N&&N.l(p),J=$(p),Q=E(p,"DIV",{class:!0}),P(Q).forEach(c),q=$(p),V&&V.l(p),p.forEach(c),S.forEach(c),this.h()},h(){b(n,"class",u="font-bold text-xs px-2 py-1 "+i[15][i[6]]+" "+i[14][i[6]]+" rounded-[5px] svelte-l0thby"),b(t,"class","flex justify-between text-secondary-foreground items-center mb-4"),b(d,"class","font-bold text-secondary uppercase text-sm"),b(U,"class",x=i[9]?"text-[2.875rem]":"text-6xl"),b(C,"class","font-bold text-primary flex items-center justify-center gap-2 max-h-[60px] mb-2"),b(f,"class","flex flex-col gap-2 items-center"),b(Q,"class","border w-full border-dashed border-[#DFE5E7]"),b(r,"class","flex flex-col items-center gap-6"),b(e,"class",I="rounded-2xl shadow-sm bg-white overflow-clip w-full border-b-[6px] "+i[13][i[6]]+" p-4 md:p-6 svelte-l0thby")},m(h,S){L(h,e,S),m(e,t),m(t,n),m(n,s),m(n,l),m(t,o),R&&R.m(t,null),m(e,a),m(e,r),m(r,f),m(f,d),m(d,g),m(f,T),m(f,C),m(C,U),M.m(U,null),m(C,Z),B&&B.m(C,null),m(f,ne),ce[y].m(f,null),m(r,k),N&&N.m(r,null),m(r,J),m(r,Q),m(r,q),V&&V.m(r,null),W=!0},p(h,[S]){(!W||S&2048)&&ue(l,h[11]),(!W||S&64&&u!==(u="font-bold text-xs px-2 py-1 "+h[15][h[6]]+" "+h[14][h[6]]+" rounded-[5px] svelte-l0thby"))&&b(n,"class",u),h[2]&&h[8]&&!h[5]?R?(R.p(h,S),S&292&&D(R,1)):(R=Qe(h),R.c(),D(R,1),R.m(t,null)):R&&(pe(),F(R,1,1,()=>{R=null}),me()),(!W||S&2)&&_!==(_=(new Date(h[1].expectedTime).toDateString()===new Date().toDateString()?"Aujourd'hui":new Date(h[1].expectedTime).toLocaleDateString(Ie(),{weekday:"short",day:"numeric",month:"short"}))+"")&&ue(g,_),K===(K=fe(h))&&M?M.p(h,S):(M.d(1),M=K(h),M&&(M.c(),M.m(U,null))),(!W||S&512&&x!==(x=h[9]?"text-[2.875rem]":"text-6xl"))&&b(U,"class",x),h[4]==="coming"||h[4]==="youAreNext"||h[4]==="iminent"?B?B.p(h,S):(B=Ze(h),B.c(),B.m(C,null)):B&&(B.d(1),B=null);let de=y;y=he(h),y===de?ce[y].p(h,S):(pe(),F(ce[de],1,1,()=>{ce[de]=null}),me(),j=ce[y],j?j.p(h,S):(j=ce[y]=re[y](h),j.c()),D(j,1),j.m(f,null)),h[2]&&h[4]!=="yourTurn"&&h[4]!=="inProgress"&&h[4]!=="done"&&!h[5]?N?(N.p(h,S),S&52&&D(N,1)):(N=Xe(h),N.c(),D(N,1),N.m(r,J)):N&&(pe(),F(N,1,1,()=>{N=null}),me()),h[3]?V?V.p(h,S):(V=et(h),V.c(),V.m(r,null)):V&&(V.d(1),V=null),(!W||S&64&&I!==(I="rounded-2xl shadow-sm bg-white overflow-clip w-full border-b-[6px] "+h[13][h[6]]+" p-4 md:p-6 svelte-l0thby"))&&b(e,"class",I)},i(h){W||(D(R),D(j),D(N),W=!0)},o(h){F(R),F(j),F(N),W=!1},d(h){h&&c(e),R&&R.d(),M.d(),B&&B.d(),ce[y].d(),N&&N.d(),V&&V.d()}}}function kn(i,e,t){let n,s,l,u,{ticket:o}=e,{isTicketGeneratedByClient:a}=e,{prestation:r}=e,{ticketStatus:f}=e,{popupType:d}=e,{isCancelledOrProAbsent:_=!1}=e,{theme:g}=e,{timeWithLateTime:T=null}=e,{isExpectedTimeClose:C=!1}=e;const U=o.details.left_to_pay?o.details.already_paid>0?"acompte_verse":"toPayOnPlace":"paid";let x=U;const Z={acompte_verse:{text:"Acompte versé",icon:Vt},toPayOnPlace:{text:"À regler sur place",icon:_t},paid:{text:"Déjà payé en ligne",icon:Mt,bg:"bg-[#23BBAC]"}},ne={coming:{text:"Heure estimée",icon:Le},youAreNext:{text:"C'est bientôt à vous",icon:Le,bg:"bg-[#00D4AA]",textColor:"text-white"},iminent:{text:"Passage imminent",icon:en,bg:"bg-[#00D4AA]",textColor:"text-white"},inProgress:{text:"Heure de fin estimée",icon:Le},yourTurn:null,isLate:{text:"Retard signalé",icon:Le,textColor:"text-[#FF834D]"}},y={NEUTRAL:"bg-primary",PINK:"bg-[#CF95FB]",CARDEN:"bg-[#0073FF]"},j={NEUTRAL:"border-primary",PINK:"border-[#CF95FB]",CARDEN:"border-[#0073FF]"},k={NEUTRAL:"text-[#616163]",PINK:"text-[#CF95FB]",CARDEN:"text-[#0073FF]"},J={NEUTRAL:"bg-[#F7F7F7]",PINK:"bg-[#FFF5FA]",CARDEN:"bg-[#F8FAFD]"};let Q=ne[f];const q=()=>t(0,d="HOUR_CHANGE");return i.$$set=I=>{"ticket"in I&&t(1,o=I.ticket),"isTicketGeneratedByClient"in I&&t(2,a=I.isTicketGeneratedByClient),"prestation"in I&&t(3,r=I.prestation),"ticketStatus"in I&&t(4,f=I.ticketStatus),"popupType"in I&&t(0,d=I.popupType),"isCancelledOrProAbsent"in I&&t(5,_=I.isCancelledOrProAbsent),"theme"in I&&t(6,g=I.theme),"timeWithLateTime"in I&&t(16,T=I.timeWithLateTime),"isExpectedTimeClose"in I&&t(17,C=I.isExpectedTimeClose)},i.$$.update=()=>{i.$$.dirty&2&&t(11,n=o.details.number),i.$$.dirty&65538&&t(10,s=T?Fe(T):Fe(new Date(o.expectedTime))),i.$$.dirty&2&&t(18,x=o.status||U),i.$$.dirty&16&&t(9,l=f==="done"||f==="cancelled"||f==="cancelledByPro"||f==="inProgress"||f==="yourTurn"),i.$$.dirty&262144&&t(8,u=Z[x]),i.$$.dirty&131088&&t(7,Q=f==="iminent"&&!C?ne.coming:ne[f])},[d,o,a,r,f,_,g,Q,u,l,s,n,y,j,k,J,T,C,x,q]}class vt extends Ee{constructor(e){super(),ye(this,e,kn,Tn,we,{ticket:1,isTicketGeneratedByClient:2,prestation:3,ticketStatus:4,popupType:0,isCancelledOrProAbsent:5,theme:6,timeWithLateTime:16,isExpectedTimeClose:17})}}function tt(i,e,t){const n=i.slice();return n[6]=e[t],n[8]=t,n}function nt(i){let e,t=`★
      `,n,s;function l(){return i[5](i[8])}return{c(){e=w("button"),e.textContent=t,this.h()},l(u){e=E(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Ae(e)!=="svelte-93gc06"&&(e.textContent=t),this.h()},h(){b(e,"class","text-2xl transition-colors"),Te(e,"text-yellow-400",i[8]<i[3]),Te(e,"text-[#D9D9D9]",i[8]>=i[3])},m(u,o){L(u,e,o),n||(s=mt(e,"click",l),n=!0)},p(u,o){i=u,o&8&&Te(e,"text-yellow-400",i[8]<i[3]),o&8&&Te(e,"text-[#D9D9D9]",i[8]>=i[3])},d(u){u&&c(e),n=!1,s()}}}function wn(i){let e,t,n="Évaluez votre expérience",s,l,u=i[1].name+"",o,a,r,f=We(Array(5)),d=[];for(let _=0;_<f.length;_+=1)d[_]=nt(tt(i,f,_));return{c(){e=w("div"),t=w("h3"),t.textContent=n,s=O(),l=w("span"),o=z(u),a=O(),r=w("div");for(let _=0;_<d.length;_+=1)d[_].c();this.h()},l(_){e=E(_,"DIV",{class:!0});var g=P(e);t=E(g,"H3",{class:!0,"data-svelte-h":!0}),Ae(t)!=="svelte-xmpfad"&&(t.textContent=n),s=$(g),l=E(g,"SPAN",{class:!0});var T=P(l);o=H(T,u),T.forEach(c),a=$(g),r=E(g,"DIV",{class:!0});var C=P(r);for(let U=0;U<d.length;U+=1)d[U].l(C);C.forEach(c),g.forEach(c),this.h()},h(){b(t,"class","font-bold text-lg"),b(l,"class","text-xs text-seoncdary"),b(r,"class","flex gap-1 mt-4 bg-[#F7F7F7] py-2 justify-center items-center rounded-lg"),b(e,"class","flex flex-col p-4 justify-center bg-white rounded-2xl")},m(_,g){L(_,e,g),m(e,t),m(e,s),m(e,l),m(l,o),m(e,a),m(e,r);for(let T=0;T<d.length;T+=1)d[T]&&d[T].m(r,null)},p(_,[g]){if(g&2&&u!==(u=_[1].name+"")&&ue(o,u),g&15){f=We(Array(5));let T;for(T=0;T<f.length;T+=1){const C=tt(_,f,T);d[T]?d[T].p(C,g):(d[T]=nt(C),d[T].c(),d[T].m(r,null))}for(;T<d.length;T+=1)d[T].d(1);d.length=f.length}},i:ie,o:ie,d(_){_&&c(e),Et(d,_)}}}function En(i,e,t){let{ticket:n}=e,{location:s}=e,{ticketModules:l}=e,{googlePlaceId:u=null}=e,o=0;const a=r=>{if(t(3,o=r+1),o>3)window.open("https://search.google.com/local/writereview?placeid="+u||"ChIJwQ4iCehx5kcRpmDUrceh7ao","_blank");else{const f=new URL("https://tally.so/r/WOEgWJ");f.searchParams.set("rating",String(o)),f.searchParams.set("locationName",s.name),f.searchParams.set("ticketId",String(n.id)),f.searchParams.set("locationId",String(s.id)),window.open(f.toString(),"_blank")}};return i.$$set=r=>{"ticket"in r&&t(0,n=r.ticket),"location"in r&&t(1,s=r.location),"ticketModules"in r&&t(4,l=r.ticketModules),"googlePlaceId"in r&&t(2,u=r.googlePlaceId)},[n,s,u,o,l,a]}class yn extends Ee{constructor(e){super(),ye(this,e,En,wn,we,{ticket:0,location:1,ticketModules:4,googlePlaceId:2})}}function it(i){let e,t;function n(u,o){if(u[2]==="inProgress")return An;if(u[2]==="cancelled")return In;if(u[2]==="cancelledByPro")return Cn;if(u[2]==="proAbsent")return Dn;if(u[2]==="isLate")return Pn}let s=n(i),l=s&&s(i);return{c(){e=w("div"),l&&l.c(),this.h()},l(u){e=E(u,"DIV",{class:!0});var o=P(e);l&&l.l(o),o.forEach(c),this.h()},h(){b(e,"class",t="rounded-lg "+i[19][i[7]]+" bg-opacity-30 p-4 text-[#616163] text-sm")},m(u,o){L(u,e,o),l&&l.m(e,null)},p(u,o){s===(s=n(u))&&l?l.p(u,o):(l&&l.d(1),l=s&&s(u),l&&(l.c(),l.m(e,null))),o[0]&128&&t!==(t="rounded-lg "+u[19][u[7]]+" bg-opacity-30 p-4 text-[#616163] text-sm")&&b(e,"class",t)},d(u){u&&c(e),l&&l.d()}}}function Pn(i){let e,t,n,s,l=(i[5]?Fe(i[5]):"")+"",u;return{c(){e=z(`Une prestation a pris plus de temps que prévu, nous avons ajusté votre horaire de
            passage pour éviter de vous faire attendre sur place.
            `),t=w("p"),n=z("NOUVELLE ESTIMATION "),s=w("span"),u=z(l),this.h()},l(o){e=H(o,`Une prestation a pris plus de temps que prévu, nous avons ajusté votre horaire de
            passage pour éviter de vous faire attendre sur place.
            `),t=E(o,"P",{class:!0});var a=P(t);n=H(a,"NOUVELLE ESTIMATION "),s=E(a,"SPAN",{});var r=P(s);u=H(r,l),r.forEach(c),a.forEach(c),this.h()},h(){b(t,"class","uppercase font-bold text-sm text-[#A03203] mt-1")},m(o,a){L(o,e,a),L(o,t,a),m(t,n),m(t,s),m(s,u)},p(o,a){a[0]&32&&l!==(l=(o[5]?Fe(o[5]):"")+"")&&ue(u,l)},d(o){o&&(c(e),c(t))}}}function Dn(i){let e;return{c(){e=z(`Le professionnel a indiqué que vous êtiez absent. Contactez-le directement pour obtenir
            de l’aide ou des explications.`)},l(t){e=H(t,`Le professionnel a indiqué que vous êtiez absent. Contactez-le directement pour obtenir
            de l’aide ou des explications.`)},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function Cn(i){let e;return{c(){e=z("Le professionnel a annulé votre réservation. Contactez-le pour obtenir des explications.")},l(t){e=H(t,"Le professionnel a annulé votre réservation. Contactez-le pour obtenir des explications.")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function In(i){let e;return{c(){e=z("Vous avez annulé votre réservation.")},l(t){e=H(t,"Vous avez annulé votre réservation.")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function An(i){let e;return{c(){e=z("Informez vos proches de votre progression et horaire de fin en partageant votre ticket.")},l(t){e=H(t,"Informez vos proches de votre progression et horaire de fin en partageant votre ticket.")},m(t,n){L(t,e,n)},p:ie,d(t){t&&c(e)}}}function st(i){let e,t;return e=new ht({props:{ticketStatus:i[2],isExpectedTimeClose:i[6],queueInfo:i[0].queueInfo,queuePosition:i[0].queuePosition,ticketProgress:i[0].queuePosition===0?i[3]:i[4]}}),{c(){X(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,s){ee(e,n,s),t=!0},p(n,s){const l={};s[0]&4&&(l.ticketStatus=n[2]),s[0]&64&&(l.isExpectedTimeClose=n[6]),s[0]&1&&(l.queueInfo=n[0].queueInfo),s[0]&1&&(l.queuePosition=n[0].queuePosition),s[0]&25&&(l.ticketProgress=n[0].queuePosition===0?n[3]:n[4]),e.$set(l)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function lt(i){let e,t;return e=new yn({props:{location:i[9],ticketModules:i[0].queueInfo.ticketModules,ticket:i[1],googlePlaceId:i[0].config.google_place_id}}),{c(){X(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,s){ee(e,n,s),t=!0},p(n,s){const l={};s[0]&512&&(l.location=n[9]),s[0]&1&&(l.ticketModules=n[0].queueInfo.ticketModules),s[0]&2&&(l.ticket=n[1]),s[0]&1&&(l.googlePlaceId=n[0].config.google_place_id),e.$set(l)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function ot(i){let e,t;return e=new gt({props:{size:"sm",variant:"outline",class:" w-3/4 border "+(i[12]?"bg-[#DFE5E7] cursor-not-allowed border-[#DFE5E7] ":i[20][i[7]])+"  text-white  "+i[21][i[7]],$$slots:{default:[Sn]},$$scope:{ctx:i}}}),e.$on("click",i[31]),{c(){X(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,s){ee(e,n,s),t=!0},p(n,s){const l={};s[0]&4224&&(l.class=" w-3/4 border "+(n[12]?"bg-[#DFE5E7] cursor-not-allowed border-[#DFE5E7] ":n[20][n[7]])+"  text-white  "+n[21][n[7]]),s[1]&2048&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function Sn(i){let e;return{c(){e=z("Annuler la réservation")},l(t){e=H(t,"Annuler la réservation")},m(t,n){L(t,e,n)},d(t){t&&c(e)}}}function rt(i){let e,t;return e=new gt({props:{href:"/"+i[17],size:"sm",variant:"outline",class:" w-3/4 "+(i[2]==="done"||i[8]?` ${i[20][i[7]]}  text-white`:`bg-transparent ${i[22][i[7]]}`)+" border "+i[21][i[7]],$$slots:{default:[Ln]},$$scope:{ctx:i}}}),{c(){X(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,s){ee(e,n,s),t=!0},p(n,s){const l={};s[0]&388&&(l.class=" w-3/4 "+(n[2]==="done"||n[8]?` ${n[20][n[7]]}  text-white`:`bg-transparent ${n[22][n[7]]}`)+" border "+n[21][n[7]]),s[1]&2048&&(l.$$scope={dirty:s,ctx:n}),e.$set(l)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function Ln(i){let e;return{c(){e=z("Nouvelle réservation")},l(t){e=H(t,"Nouvelle réservation")},m(t,n){L(t,e,n)},d(t){t&&c(e)}}}function at(i){let e,t;return e=new ht({props:{isExpectedTimeClose:i[6],ticketStatus:i[2],queueInfo:i[0].queueInfo,queuePosition:i[0].queuePosition}}),{c(){X(e.$$.fragment)},l(n){le(e.$$.fragment,n)},m(n,s){ee(e,n,s),t=!0},p(n,s){const l={};s[0]&64&&(l.isExpectedTimeClose=n[6]),s[0]&4&&(l.ticketStatus=n[2]),s[0]&1&&(l.queueInfo=n[0].queueInfo),s[0]&1&&(l.queuePosition=n[0].queuePosition),e.$set(l)},i(n){t||(D(e.$$.fragment,n),t=!0)},o(n){F(e.$$.fragment,n),t=!1},d(n){te(e,n)}}}function ut(i){let e,t,n,s,l,u="Reste à payer sur place",o,a=He(i[13])+"",r,f;return s=new _t({props:{size:"18"}}),{c(){e=w("div"),t=w("div"),n=w("div"),X(s.$$.fragment),l=w("span"),l.textContent=u,o=O(),r=z(a),this.h()},l(d){e=E(d,"DIV",{class:!0});var _=P(e);t=E(_,"DIV",{class:!0});var g=P(t);n=E(g,"DIV",{class:!0});var T=P(n);le(s.$$.fragment,T),l=E(T,"SPAN",{class:!0,"data-svelte-h":!0}),Ae(l)!=="svelte-fbi89w"&&(l.textContent=u),T.forEach(c),o=$(g),r=H(g,a),g.forEach(c),_.forEach(c),this.h()},h(){b(l,"class",""),b(n,"class","flex gap-2"),b(t,"class","flex justify-between gap-2 w-full font-bold text-sm text-primary"),b(e,"class","bg-white p-4 flex items-center rounded-2xl shadow-sm -mt-2")},m(d,_){L(d,e,_),m(e,t),m(t,n),ee(s,n,null),m(n,l),m(t,o),m(t,r),f=!0},p(d,_){(!f||_[0]&8192)&&a!==(a=He(d[13])+"")&&ue(r,a)},i(d){f||(D(s.$$.fragment,d),f=!0)},o(d){F(s.$$.fragment,d),f=!1},d(d){d&&c(e),te(s)}}}function Nn(i){let e,t,n;const s=[i[11]];function l(o){i[32](o)}let u={};for(let o=0;o<s.length;o+=1)u=Ce(u,s[o]);return i[10]!==void 0&&(u.popupType=i[10]),e=new vt({props:u}),qe.push(()=>Ve(e,"popupType",l)),{c(){X(e.$$.fragment)},l(o){le(e.$$.fragment,o)},m(o,a){ee(e,o,a),n=!0},p(o,a){const r=a[0]&2048?Re(s,[Me(o[11])]):{};!t&&a[0]&1024&&(t=!0,r.popupType=o[10],Be(()=>t=!1)),e.$set(r)},i(o){n||(D(e.$$.fragment,o),n=!0)},o(o){F(e.$$.fragment,o),n=!1},d(o){te(e,o)}}}function Fn(i){let e,t,n,s,l,u,o,a,r,f,d,_,g,T,C,U,x,Z,ne,y,j,k,J,Q,q,I,W,R,fe;t=new Lt({props:{headerCover:i[15],location:i[9],locationStatus:i[16],theme:i[7],fullAddress:i[14]}});let K=i[2]!=="done"&&i[2]!=="yourTurn"&&i[2]!=="coming"&&i[2]!=="youAreNext"&&i[2]!=="iminent"&&it(i),M=i[0].queuePosition<2&&!i[8]&&st(i),B=i[2]==="done"&&lt(i);const re=[i[11]];function ce(p){i[30](p)}let he={};for(let p=0;p<re.length;p+=1)he=Ce(he,re[p]);i[10]!==void 0&&(he.popupType=i[10]),f=new vt({props:he}),qe.push(()=>Ve(f,"popupType",ce));let N=i[2]!=="done"&&!i[8]&&ot(i),V=i[2]!=="isLate"&&rt(i),h=i[0].queuePosition>1&&!i[8]&&at(i),S=i[13]&&!i[8]&&ut(i);Z=new Nt({props:{location:i[9],mode:"mobile"}}),y=new Ft({props:{fullAddress:i[14],location:i[9]}}),k=new ln({props:{sticky:!0,$$slots:{default:[Nn]},$$scope:{ctx:i}}});function de(p){i[33](p)}let ve={};return i[10]!==void 0&&(ve.popupTypeOpen=i[10]),q=new Rt({props:ve}),qe.push(()=>Ve(q,"popupTypeOpen",de)),q.$on("confirmAction",i[34]),R=new It({}),{c(){e=w("main"),X(t.$$.fragment),n=O(),s=w("div"),l=w("div"),K&&K.c(),u=O(),M&&M.c(),o=O(),B&&B.c(),a=O(),r=w("div"),X(f.$$.fragment),_=O(),g=w("div"),N&&N.c(),T=O(),V&&V.c(),C=O(),h&&h.c(),U=O(),S&&S.c(),x=O(),X(Z.$$.fragment),ne=O(),X(y.$$.fragment),j=O(),X(k.$$.fragment),Q=O(),X(q.$$.fragment),W=O(),X(R.$$.fragment),this.h()},l(p){e=E(p,"MAIN",{class:!0});var A=P(e);le(t.$$.fragment,A),n=$(A),s=E(A,"DIV",{class:!0});var oe=P(s);l=E(oe,"DIV",{class:!0});var v=P(l);K&&K.l(v),u=$(v),M&&M.l(v),o=$(v),B&&B.l(v),a=$(v),r=E(v,"DIV",{class:!0});var G=P(r);le(f.$$.fragment,G),G.forEach(c),_=$(v),g=E(v,"DIV",{class:!0});var Y=P(g);N&&N.l(Y),T=$(Y),V&&V.l(Y),Y.forEach(c),C=$(v),h&&h.l(v),U=$(v),S&&S.l(v),x=$(v),le(Z.$$.fragment,v),ne=$(v),le(y.$$.fragment,v),v.forEach(c),j=$(oe),le(k.$$.fragment,oe),oe.forEach(c),A.forEach(c),Q=$(p),le(q.$$.fragment,p),W=$(p),le(R.$$.fragment,p),this.h()},h(){b(r,"class","lg:hidden w-full"),b(g,"class","flex justify-center flex-col items-center gap-4"),b(l,"class","w-full flex flex-col gap-8 md:gap-16 max-w-screen lg:max-w-lg xl:max-w-2xl 2xl:max-w-3xl px-4 mt-4"),b(s,"class","flex flex-row justify-between max-w-screen md:px-8 lg:px-12 xl:px-16 2xl:px-40 gap-8"),b(e,"class",J=i[18][i[7]]+"")},m(p,A){L(p,e,A),ee(t,e,null),m(e,n),m(e,s),m(s,l),K&&K.m(l,null),m(l,u),M&&M.m(l,null),m(l,o),B&&B.m(l,null),m(l,a),m(l,r),ee(f,r,null),m(l,_),m(l,g),N&&N.m(g,null),m(g,T),V&&V.m(g,null),m(l,C),h&&h.m(l,null),m(l,U),S&&S.m(l,null),m(l,x),ee(Z,l,null),m(l,ne),ee(y,l,null),m(s,j),ee(k,s,null),L(p,Q,A),ee(q,p,A),L(p,W,A),ee(R,p,A),fe=!0},p(p,A){const oe={};A[0]&32768&&(oe.headerCover=p[15]),A[0]&512&&(oe.location=p[9]),A[0]&65536&&(oe.locationStatus=p[16]),A[0]&128&&(oe.theme=p[7]),A[0]&16384&&(oe.fullAddress=p[14]),t.$set(oe),p[2]!=="done"&&p[2]!=="yourTurn"&&p[2]!=="coming"&&p[2]!=="youAreNext"&&p[2]!=="iminent"?K?K.p(p,A):(K=it(p),K.c(),K.m(l,u)):K&&(K.d(1),K=null),p[0].queuePosition<2&&!p[8]?M?(M.p(p,A),A[0]&257&&D(M,1)):(M=st(p),M.c(),D(M,1),M.m(l,o)):M&&(pe(),F(M,1,1,()=>{M=null}),me()),p[2]==="done"?B?(B.p(p,A),A[0]&4&&D(B,1)):(B=lt(p),B.c(),D(B,1),B.m(l,a)):B&&(pe(),F(B,1,1,()=>{B=null}),me());const v=A[0]&2048?Re(re,[Me(p[11])]):{};!d&&A[0]&1024&&(d=!0,v.popupType=p[10],Be(()=>d=!1)),f.$set(v),p[2]!=="done"&&!p[8]?N?(N.p(p,A),A[0]&260&&D(N,1)):(N=ot(p),N.c(),D(N,1),N.m(g,T)):N&&(pe(),F(N,1,1,()=>{N=null}),me()),p[2]!=="isLate"?V?(V.p(p,A),A[0]&4&&D(V,1)):(V=rt(p),V.c(),D(V,1),V.m(g,null)):V&&(pe(),F(V,1,1,()=>{V=null}),me()),p[0].queuePosition>1&&!p[8]?h?(h.p(p,A),A[0]&257&&D(h,1)):(h=at(p),h.c(),D(h,1),h.m(l,U)):h&&(pe(),F(h,1,1,()=>{h=null}),me()),p[13]&&!p[8]?S?(S.p(p,A),A[0]&8448&&D(S,1)):(S=ut(p),S.c(),D(S,1),S.m(l,x)):S&&(pe(),F(S,1,1,()=>{S=null}),me());const G={};A[0]&512&&(G.location=p[9]),Z.$set(G);const Y={};A[0]&16384&&(Y.fullAddress=p[14]),A[0]&512&&(Y.location=p[9]),y.$set(Y);const _e={};A[0]&3072|A[1]&2048&&(_e.$$scope={dirty:A,ctx:p}),k.$set(_e),(!fe||A[0]&128&&J!==(J=p[18][p[7]]+""))&&b(e,"class",J);const ge={};!I&&A[0]&1024&&(I=!0,ge.popupTypeOpen=p[10],Be(()=>I=!1)),q.$set(ge)},i(p){fe||(D(t.$$.fragment,p),D(M),D(B),D(f.$$.fragment,p),D(N),D(V),D(h),D(S),D(Z.$$.fragment,p),D(y.$$.fragment,p),D(k.$$.fragment,p),D(q.$$.fragment,p),D(R.$$.fragment,p),fe=!0)},o(p){F(t.$$.fragment,p),F(M),F(B),F(f.$$.fragment,p),F(N),F(V),F(h),F(S),F(Z.$$.fragment,p),F(y.$$.fragment,p),F(k.$$.fragment,p),F(q.$$.fragment,p),F(R.$$.fragment,p),fe=!1},d(p){p&&(c(e),c(Q),c(W)),te(t),K&&K.d(),M&&M.d(),B&&B.d(),te(f),N&&N.d(),V&&V.d(),h&&h.d(),S&&S.d(),te(Z),te(y),te(k),te(q,p),te(R,p)}}}function qn(i,e,t){let n,s,l,u,o,a,r,f,d,_,g,T,C,U,x,Z,ne;yt(i,St,v=>t(29,ne=v));let{data:y}=e;const j=y.location.location.id;let k=y.ticket,J=null,Q,q=0,I=0,W=null;const R=()=>{let v="coming";if(k.doneTime)return v="done",v;if(k.canceledTime)return k.canceledByPro?v="cancelledByPro":v="cancelled",v;if(K())return v="isLate",v;if(y.queuePosition>1)v="coming";else if(y.queuePosition===1)I&&I>75?v="iminent":v="youAreNext";else if(y.queuePosition===0){const G=new Date(k.expectedTime).getTime(),_e=Date.now()>=G-5*60*1e3;k.startedTime?v="inProgress":_e?v="yourTurn":v="coming"}return v},fe=v=>{const G=new Date(v.expectedTime).getTime(),Y=v.startedTime;return Y&&new Date(Y).getTime()<G?new Date(Y).getTime():G},K=()=>{if(!y.queueLen)return!1;const v=y.queueLen.filter(ae=>ae.id!==k.id&&new Date(ae.expectedTime).getTime()<=new Date(k.expectedTime).getTime());if(v.length===0)return!1;const G=v[v.length-1],Y=fe(G),_e=G.duration*1e3,ge=Y+_e;if(ge>new Date(k.expectedTime).getTime())return t(5,W=new Date(ge)),!0;const be=v[0];let ke=fe(be);for(const ae of v){const Pe=ae.duration*1e3;ke+=Pe}const se=new Date(k.expectedTime).getTime();return ke>se?(t(5,W=new Date(ke)),!0):(t(5,W=null),!1)},M=v=>{if(!l||!v||!v.startedTime||!v.durationS&&!v.duration)return 0;const G=v,Y=new Date(G.startedTime),_e=G.durationS||G.duration,ge=(l.getTime()-Y.getTime())/1e3,be=Math.min(ge/_e*100,100);return be<0?0:be},B=v=>{var Y;const G=JSON.parse(v.data);if(G.type==="sync"){console.log("parsedData",G);const ge=G.queueLines.flatMap(se=>se.tickets),be=ge.find(se=>se.id===k.id),Se=new Date,ke=ge.filter(se=>{const ae=new Date(se.expectedTime).getTime()<new Date(be.expectedTime).getTime(),Pe=new Date(se.creationTime),bt=Pe.getFullYear()===Se.getFullYear()&&Pe.getMonth()===Se.getMonth()&&Pe.getDate()===Se.getDate();return se.doctorId===k.doctorId&&se.id!==k.id&&se.locationId===k.locationId&&bt&&ae&&!se.doneTime&&!se.canceledTime&&!se.deletedTime});if(be&&(t(1,k=be),t(1,k)),console.log("otherTicketsOnLocation",ke),ke.length){const se=[];for(const ae of ke)se.push({duration:ae.durationS,expectedTime:ae.expectedTime,id:ae.id,startedTime:ae.startedTime,number:ae.details.number,isBreak:((Y=ae.details)==null?void 0:Y.tickettype)==="BREAK"});t(0,y.queueLen=[...se,{duration:k.durationS,expectedTime:k.expectedTime,id:k.id,startedTime:k.startedTime,number:k.details.number,isBreak:!1}],y),t(0,y.queuePosition=se.filter(ae=>!ae.isBreak).length,y),t(0,y.data=y,y)}else t(0,y.queueLen=[],y),t(0,y.queuePosition=0,y),t(0,y.data=y,y)}};let re=null;Pt(()=>{re==null&&(re=new EventSource(`${De}/api/v2/location/events?token=${n.id}`),re.onopen=()=>{},re.onmessage=B,re.onerror=v=>{console.error(`[!] sse error ${v}`)})}),Dt(()=>{re!=null&&(re.close(),re=null)});const ce=()=>(new Date(k.expectedTime).getTime()-new Date().getTime())/(1e3*60)<=30,he={CARDEN:"bg-[#F8FAFD]",NEUTRAL:"bg-[#F8FAFD]",PINK:"bg-gradient-to-b from-[#FAF5FF] via-[#FDF2F8] to-[#FFF1F2]"},N={CARDEN:"bg-[#C7E0FF]",NEUTRAL:"bg-[#DFE5E7]",PINK:"bg-[#E5CEF7]"},V={CARDEN:"bg-[#0073FF]",NEUTRAL:"bg-primary",PINK:"bg-[#CF95FB]"},h={CARDEN:"border-[#0073FF]",NEUTRAL:"border-primary",PINK:"border-[#CF95FB]"},S={CARDEN:"text-[#0073FF]",NEUTRAL:"text-primary",PINK:"text-[#CF95FB]"};function de(v){J=v,t(10,J)}const ve=v=>{if(C){v.preventDefault();return}t(10,J="CANCEL_RESERVATION")};function p(v){J=v,t(10,J)}function A(v){J=v,t(10,J)}const oe=async()=>{J==="CANCEL_RESERVATION"&&await fetch(`${De}/api/v2/ticket/${k.id}/status`,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify("CANCELED")})};return i.$$set=v=>{"data"in v&&t(0,y=v.data)},i.$$.update=()=>{i.$$.dirty[0]&1&&console.log("data",y),i.$$.dirty[0]&1&&t(9,n=y.location.location),i.$$.dirty[0]&512&&t(7,s=n.theme),i.$$.dirty[0]&536870912&&t(28,l=new Date(ne)),i.$$.dirty[0]&268435456&&t(27,u=new Date(l.getTime()+5*60*1e3)),i.$$.dirty[0]&402653185&&t(26,o=qt(y.location,l,u)),i.$$.dirty[0]&67108864&&t(16,a=kt(o)),i.$$.dirty[0]&512&&t(15,r=n.banner??"/location-cover.webp"),i.$$.dirty[0]&512&&t(14,f=`${n.address}, ${n.zipCode}
        ${n.city}`),i.$$.dirty[0]&2&&t(24,d=k.details.prestations[0]),i.$$.dirty[0]&2&&t(13,_=k.details.left_to_pay),i.$$.dirty[0]&2&&t(23,g=k.details.eticket),i.$$.dirty[0]&1&&t(25,T=y.queueLen[y.queuePosition-1]),i.$$.dirty[0]&570425346&&(t(3,q=M(k)),t(4,I=M(T))),i.$$.dirty[0]&25&&(y.queuePosition,t(2,Q=R())),i.$$.dirty[0]&4&&t(12,C=["yourTurn","inProgress"].includes(Q)),i.$$.dirty[0]&4&&t(8,U=Q==="cancelled"||Q==="cancelledByPro"||Q==="proAbsent"),i.$$.dirty[0]&25166310&&t(11,x={ticketStatus:Q,ticket:k,prestation:d,isTicketGeneratedByClient:g,isCancelledOrProAbsent:U,theme:s,timeWithLateTime:W,isExpectedTimeClose:Z})},t(6,Z=ce()),[y,k,Q,q,I,W,Z,s,U,n,J,x,C,_,f,r,a,j,he,N,V,h,S,g,d,T,o,u,l,ne,de,ve,p,A,oe]}class ti extends Ee{constructor(e){super(),ye(this,e,qn,Fn,we,{data:0},null,[-1,-1])}}export{ti as component,ei as universal};
